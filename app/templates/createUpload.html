{% extends "base.html" %}
{% block content %}
    <script type="text/javascript" src="//api.filestackapi.com/filestack.js"></script>
    <script type="text/javascript" src="/static/filepicker.js"></script>

    <div class="section">
        <ul class="pagination">
            <li class="disabled"><a href="#!"><i class="material-icons">chevron_left</i></a></li>
            <li class="blue active"><a href="#!">1</a></li>
            <li class="waves-effect"><a href="createSearch.html">2</a></li>
            <li class="waves-effect"><a href="#!">3</a></li>
            <li class="waves-effect"><a href="#!"><i class="material-icons">chevron_right</i></a></li>
        </ul>
    </div>
    <div class="section"></div>
    <div class="white section">
        <h5 class="grey-text text-darken-2" id="instructions">1. Upload Collection</h1>
        <h6 class="grey-text left-margin">Please upload your collection (csv/excel)*</h6>
        <div class="section"></div>
          <div class="file-field input-field" id="upload">
              <div class="row">
                <div class="col s3">
                  <form method="POST" action="{{ url_for('previewUpload') }}" id="filepicker">
                    <input type=filepicker data-fp-apikey="AwWNg6Ei3SHyfKegusrWIz" data-fp-extensions=".csv,.xls,.xlsx,.gsheet" data-fp-services="COMPUTER,GOOGLE_DRIVE" data-fp-maxFiles="1" onchange="submit_form()">
                  </form>
                </div>
              </div>
           </div>
        <div class="divider top-margin"></div>
        <p class="grey-text text-darken-2 left-margin">*1. Each column will be a header <br> 2. You can combine headers to create search fields</p>
        </div>
    </div>
    <div class="section">
        <a class="waves-effect waves-light red accent-2 btn right" href="{{ url_for('createSearch')}}">Next</a>
    </div>
    <div id="file-preview-container">
      <!--<div type="filepicker-preview" data-fp-url="https://www.filestackapi.com/api/file/S8O2rWoSFewERT8AfNxW" style="width:75%; height:1500px"> </div>-->
    </div>

<script>
  function submit_form() {
    // Send URL to be processed in backend
    var url = '/saveFile';
    $.post(url,
      {
        url: window.event.fpfile["url"]
      }
    )
    document.getElementById("filepicker").submit()
  }
</script>


 {% endblock %}
